var Wn=Object.defineProperty;var $n=(e,t,n)=>t in e?Wn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var X=(e,t,n)=>($n(e,typeof t!="symbol"?t+"":t,n),n);import{w as f}from"./index.c833c631.js";var Yn=(e=>(e.WARP_MODE="WARP_MODE",e.THEME="THEME",e.CANVAS_BORDER="CANVAS_BORDER",e.SHAKING="SHAKING",e.CPU_REVISION="CPU_REVISION",e.CPU_SPEED="CPU_SPEED",e.AGNUS_REVISION="AGNUS_REVISION",e.DENISE_REVISION="DENISE_REVISION",e.RTC_MODEL="RTC_MODEL",e.CHIP_RAM="CHIP_RAM",e.SLOW_RAM="SLOW_RAM",e.FAST_RAM="FAST_RAM",e.BANK_MAP="BANK_MAP",e.INIT_PATTERN="INIT_PATTERN",e.UNMAPPED="UNMAPPED",e.SLOW_RAM_MIRROR="SLOW_RAM_MIRROR",e.SLOW_RAM_DELAY="SLOW_RAM_DELAY",e.DF0="DF0",e.DF1="DF1",e.DF2="DF2",e.DF3="DF3",e.HD0="HD0",e.HD1="HD1",e.HD2="HD2",e.HD3="HD3",e.BLIITTER_ACCURACY="BLIITTER_ACCURACY",e.TODBUG="TODBUG",e.PTR_DROPS="PTR_DROPS",e.ECLOCK_SYNCING="ECLOCK_SYNCING",e.DRIVE_SPEED="DRIVE_SPEED",e.DRIVE_MECHANICS="DRIVE_MECHANICS",e.OPT_LOCK_DSKSYNC="OPT_LOCK_DSKSYNC",e.OPT_AUTO_DSKSYNC="OPT_AUTO_DSKSYNC",e.CLX_SPR_SPR="CLX_SPR_SPR",e.CLX_SPR_PLF="CLX_SPR_PLF",e.CLX_PLF_PLF="CLX_PLF_PLF",e.ACCURATE_KEYBOARD="ACCURATE_KEYBOARD",e.AUDVOL0="AUDVOL0",e.AUDVOL1="AUDVOL1",e.AUDVOL2="AUDVOL2",e.AUDVOL3="AUDVOL3",e.AUDVOLL="AUDVOLL",e.AUDVOLR="AUDVOLR",e.STEP_VOLUME="STEP_VOLUME",e.POLL_VOLUME="POLL_VOLUME",e.INSERT_VOLUME="INSERT_VOLUME",e.EJECT_VOLUME="EJECT_VOLUME",e.RENDER_MODE="RENDER_MODE",e.FLICKER_WEIGHT="FLICKER_WEIGHT",e.PALETTE="PALETTE",e.BRIGHTNESS="BRIGHTNESS",e.CONTRAST="CONTRAST",e.SATURATION="SATURATION",e))(Yn||{}),Gn=(e=>(e[e.none=0]="none",e[e.mouse=1]="mouse",e[e.keyset1=2]="keyset1",e[e.keyset2=3]="keyset2",e[e.gamepad1=4]="gamepad1",e[e.gamepad2=5]="gamepad2",e))(Gn||{}),yn=(e=>(e[e.none=0]="none",e[e.dropzone=1]="dropzone",e[e.kickstart=2]="kickstart",e[e.settings=3]="settings",e[e.shell=4]="shell",e[e.showcases=5]="showcases",e))(yn||{}),zn=(e=>(e[e.smooth=0]="smooth",e[e.pixelated=1]="pixelated",e))(zn||{}),Xn=(e=>(e[e.default=0]="default",e[e.light=1]="light",e[e.dark=2]="dark",e[e.coffee=3]="coffee",e[e.cupcake=4]="cupcake",e[e.forest=5]="forest",e[e.aqua=6]="aqua",e[e.garden=7]="garden",e[e.pastel=8]="pastel",e))(Xn||{}),Qn=(e=>(e[e.auto=0]="auto",e[e.never=1]="never",e[e.always=2]="always",e))(Qn||{});class Jn{constructor(t,n){X(this,"title","");X(this,"tag",0);X(this,"isEnabled",!0);X(this,"isHidden",!1);X(this,"isSelected",!1);X(this,"isSeparator",!1);this.title=t,this.tag=n}}class Gr extends Jn{constructor(){super("",0)}}const zr=f(),Xr=f(!1),Qr=f(),Jr=f(),Zr=f(),es=f(),ts=f(),ns=f(),rs=f(),ss=f(),as=f(),os=f(),is=f(),cs=f(),us=f(),ls=f(),hs=f(),ds=f(),fs=f(),ps=f(),ys=f(),ms=f(),gs=f(),bs=f(),vs=f(),_s=f(),ws=f(),ks=f(!0),Es=f("invert"),xs=f(1),Ss=f(0),Ps=f(),As=f(),Cs=f(0),Ks=f(0),Ds=f(0),Ms=f(0),Rs=f("fit"),Os=f(!1),Is=f(yn.none),Ts=f(null),Ns=f(""),Bs=f(!1),js=f(!1),Fs=f(!1),Ls=f(0),Us=f(!1),qs=f(!1),Vs=f(!1),Hs=f(!1),Ws=f([!1,!1,!1,!1]),$s=f([!1,!1,!1,!1]),Ys=f([!1,!1,!1,!1]),Gs=f([!1,!1,!1,!1]),zs=f([!1,!1,!1,!1]),Xs=f([!1,!1,!1,!1]),Qs=f([0,0,0,0]),Js=f([!1,!1,!1,!1]),Zs=f([!1,!1,!1,!1]),ea=f([!1,!1,!1,!1]),ta=f([!1,!1,!1,!1]),na=f([0,0,0,0]),ra=f([]),sa=f(0),aa=f(0),oa=f(""),ia=f(0),ca=f(0),ua=f(0),la=f(0),ha=f(0),da=f(0),fa=f(0),pa=f(0),ya=f(0),ma=f(0),ga=f(0),ba=f(0),va=f(0),_a=f(0),wa=f(0),ka=f(0),Ea=f(0),xa=f(0),Sa=f(0),Pa=f(0),Aa=f(0),Ca=f(0),Ka=f(0),Da=f(0),Ma=f(0),Ra=f(0),Oa=f(0),Ia=f(0),Ta=f(0),Na=f(0),Ba=f(0),ja=f(0),Fa=f(0),La=f(0),Ua=f(0),qa=f(0),Va=f(0),Ha=f(0),Wa=f(0),$a=f(0),Ya=f(0),Ga=f(0),za=f(0),Xa=f(0),Qa=f(0),Ja=f(0),Za=f(0),eo=f(0),to=f(0),no=f(0),ro=f(0),so=f(0),ao=f(0),oo=f(0),io=f(0),co=f(0),uo=f(0),lo=f(0),ho=f(0),fo=f(0),po=f(0),yo=f(0),mo=f(0),go=f(0),bo=f(0),vo=f(0),_o=f(0),wo=f(0),ko=f(0),Eo=f(0),R=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N=Object.keys,L=Array.isArray;function V(e,t){return typeof t!="object"||N(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||R.Promise||(R.Promise=Promise);const je=Object.getPrototypeOf,Zn={}.hasOwnProperty;function $(e,t){return Zn.call(e,t)}function Pe(e,t){typeof t=="function"&&(t=t(je(e))),(typeof Reflect>"u"?N:Reflect.ownKeys)(t).forEach(n=>{te(e,n,t[n])})}const mn=Object.defineProperty;function te(e,t,n,r){mn(e,t,V(n&&$(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Ee(e){return{from:function(t){return e.prototype=Object.create(t.prototype),te(e.prototype,"constructor",e),{extend:Pe.bind(null,e.prototype)}}}}const er=Object.getOwnPropertyDescriptor;function $t(e,t){let n;return er(e,t)||(n=je(e))&&$t(n,t)}const tr=[].slice;function it(e,t,n){return tr.call(e,t,n)}function gn(e,t){return t(e)}function Me(e){if(!e)throw new Error("Assertion Failed")}function bn(e){R.setImmediate?setImmediate(e):setTimeout(e,0)}function vn(e,t){return e.reduce((n,r,s)=>{var a=t(r,s);return a&&(n[a[0]]=a[1]),n},{})}function ne(e,t){if($(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,s=t.length;r<s;++r){var a=ne(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var c=e[t.substr(0,o)];return c===void 0?void 0:ne(c,t.substr(o+1))}}function Y(e,t,n){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Me(typeof n!="string"&&"length"in n);for(var r=0,s=t.length;r<s;++r)Y(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),c=t.substr(a+1);if(c==="")n===void 0?L(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var i=e[o];i&&$(e,o)||(i=e[o]={}),Y(i,c,n)}}else n===void 0?L(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function _n(e){var t={};for(var n in e)$(e,n)&&(t[n]=e[n]);return t}const nr=[].concat;function wn(e){return nr.apply([],e)}const kn="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(wn([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>R[e]),rr=kn.map(e=>R[e]);vn(kn,e=>[e,!0]);let ae=null;function He(e){ae=typeof WeakMap<"u"&&new WeakMap;const t=kt(e);return ae=null,t}function kt(e){if(!e||typeof e!="object")return e;let t=ae&&ae.get(e);if(t)return t;if(L(e)){t=[],ae&&ae.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(kt(e[n]))}else if(rr.indexOf(e.constructor)>=0)t=e;else{const a=je(e);for(var s in t=a===Object.prototype?{}:Object.create(a),ae&&ae.set(e,t),e)$(e,s)&&(t[s]=kt(e[s]))}return t}const{toString:sr}={};function Et(e){return sr.call(e).slice(8,-1)}const xt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ar=typeof xt=="symbol"?function(e){var t;return e!=null&&(t=e[xt])&&t.apply(e)}:function(){return null},ke={};function Z(e){var t,n,r,s;if(arguments.length===1){if(L(e))return e.slice();if(this===ke&&typeof e=="string")return[e];if(s=ar(e)){for(n=[];!(r=s.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const Yt=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var z=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function En(e,t){z=e,xn=t}var xn=()=>!0;const or=!new Error("").stack;function ge(){if(or)try{throw ge.arguments,new Error}catch(e){return e}return new Error}function St(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(xn).map(r=>`
`+r).join("")):""}var Sn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Sn),ir={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function xe(e,t){this._e=ge(),this.name=e,this.message=t}function Pn(e,t){return e+". Errors: "+Object.keys(t).map(n=>t[n].toString()).filter((n,r,s)=>s.indexOf(n)===r).join(`
`)}function ct(e,t,n,r){this._e=ge(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Pn(e,t)}function Oe(e,t){this._e=ge(),this.name="BulkError",this.failures=Object.keys(t).map(n=>t[n]),this.failuresByPos=t,this.message=Pn(e,t)}Ee(xe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+St(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Ee(ct).from(xe),Ee(Oe).from(xe);var zt=Gt.reduce((e,t)=>(e[t]=t+"Error",e),{});const cr=xe;var C=Gt.reduce((e,t)=>{var n=t+"Error";function r(s,a){this._e=ge(),this.name=n,s?typeof s=="string"?(this.message=`${s}${a?`
 `+a:""}`,this.inner=a||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=ir[t]||n,this.inner=null)}return Ee(r).from(cr),e[t]=r,e},{});C.Syntax=SyntaxError,C.Type=TypeError,C.Range=RangeError;var sn=Sn.reduce((e,t)=>(e[t+"Error"]=C[t],e),{}),et=Gt.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=C[t]),e),{});function D(){}function Fe(e){return e}function ur(e,t){return e==null||e===Fe?t:function(n){return t(e(n))}}function ye(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function lr(e,t){return e===D?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ye(r,this.onsuccess):r),s&&(this.onerror=this.onerror?ye(s,this.onerror):s),a!==void 0?a:n}}function hr(e,t){return e===D?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ye(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ye(r,this.onerror):r)}}function dr(e,t){return e===D?t:function(n){var r=e.apply(this,arguments);V(n,r);var s=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?ye(s,this.onsuccess):s),a&&(this.onerror=this.onerror?ye(a,this.onerror):a),r===void 0?o===void 0?void 0:o:V(r,o)}}function fr(e,t){return e===D?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Xt(e,t){return e===D?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,s=arguments.length,a=new Array(s);s--;)a[s]=arguments[s];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}et.ModifyError=ct,et.DexieError=xe,et.BulkError=Oe;var Le={};const[Pt,ut,At]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,je(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,je(t),e]})(),An=ut&&ut.then,tt=Pt&&Pt.constructor,Qt=!!At;var Ct=!1,pr=At?()=>{At.then(Ye)}:R.setImmediate?setImmediate.bind(null,Ye):R.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Ye(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Ye,0)},Ie=function(e,t){Re.push([e,t]),lt&&(pr(),lt=!1)},Kt=!0,lt=!0,de=[],nt=[],Dt=null,Mt=Fe,Se={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:on,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{on(e[0],e[1])}catch{}})}},A=Se,Re=[],fe=0,rt=[];function x(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=D,this._lib=!1;var t=this._PSD=A;if(z&&(this._stackHolder=ge(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Le)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ot(this,this._value))}this._state=null,this._value=null,++t.ref,Kn(this,e)}const Rt={get:function(){var e=A,t=ht;function n(r,s){var a=!e.global&&(e!==A||t!==ht);const o=a&&!re();var c=new x((i,d)=>{Jt(this,new Cn(dt(r,e,a,o),dt(s,e,a,o),i,d,e))});return z&&Rn(c,this),c}return n.prototype=Le,n},set:function(e){te(this,"then",e&&e.prototype===Le?Rt:{get:function(){return e},set:Rt.set})}};function Cn(e,t,n,r,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=s}function Kn(e,t){try{t(n=>{if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&We();n&&typeof n.then=="function"?Kn(e,(s,a)=>{n instanceof x?n._then(s,a):n.then(s,a)}):(e._state=!0,e._value=n,Dn(e)),r&&$e()}},Ot.bind(null,e))}catch(n){Ot(e,n)}}function Ot(e,t){if(nt.push(t),e._state===null){var n=e._lib&&We();t=Mt(t),e._state=!1,e._value=t,z&&t!==null&&typeof t=="object"&&!t._promise&&function(r,s,a){try{r.apply(null,a)}catch(o){s&&s(o)}}(()=>{var r=$t(t,"stack");t._promise=e,te(t,"stack",{get:()=>Ct?r&&(r.get?r.get.apply(t):r.value):e.stack})}),function(r){de.some(s=>s._value===r._value)||de.push(r)}(e),Dn(e),n&&$e()}}function Dn(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Jt(e,t[n]);var s=e._PSD;--s.ref||s.finalize(),fe===0&&(++fe,Ie(()=>{--fe==0&&Zt()},[]))}function Jt(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++fe,Ie(yr,[n,e,t])}else e._listeners.push(t)}function yr(e,t,n){try{Dt=t;var r,s=t._value;t._state?r=e(s):(nt.length&&(nt=[]),r=e(s),nt.indexOf(s)===-1&&function(a){for(var o=de.length;o;)if(de[--o]._value===a._value)return void de.splice(o,1)}(t)),n.resolve(r)}catch(a){n.reject(a)}finally{Dt=null,--fe==0&&Zt(),--n.psd.ref||n.psd.finalize()}}function Mn(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var s,a,o=e._value;o!=null?(s=o.name||"Error",a=o.message||o,r=St(o,0)):(s=o,a=""),t.push(s+(a?": "+a:"")+r)}return z&&((r=St(e._stackHolder,2))&&t.indexOf(r)===-1&&t.push(r),e._prev&&Mn(e._prev,t,n)),t}function Rn(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Ye(){We()&&$e()}function We(){var e=Kt;return Kt=!1,lt=!1,e}function $e(){var e,t,n;do for(;Re.length>0;)for(e=Re,Re=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(Re.length>0);Kt=!0,lt=!0}function Zt(){var e=de;de=[],e.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var t=rt.slice(0),n=t.length;n;)t[--n]()}function Ge(e){return new x(Le,!1,e)}function O(e,t){var n=A;return function(){var r=We(),s=A;try{return ie(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{ie(s,!1),r&&$e()}}}Pe(x.prototype,{then:Rt,_then:function(e,t){Jt(this,new Cn(null,null,e,t,A))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,r=>r instanceof t?n(r):Ge(r)):this.then(null,r=>r&&r.name===t?n(r):Ge(r))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),Ge(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Ct=!0;var e=Mn(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Ct=!1}}},timeout:function(e,t){return e<1/0?new x((n,r)=>{var s=setTimeout(()=>r(new C.Timeout(t)),e);this.then(n,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&te(x.prototype,Symbol.toStringTag,"Dexie.Promise"),Se.env=On(),Pe(x,{all:function(){var e=Z.apply(null,arguments).map(ze);return new x(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach((s,a)=>x.resolve(s).then(o=>{e[a]=o,--r||t(e)},n))})},resolve:e=>{if(e instanceof x)return e;if(e&&typeof e.then=="function")return new x((n,r)=>{e.then(n,r)});var t=new x(Le,!0,e);return Rn(t,Dt),t},reject:Ge,race:function(){var e=Z.apply(null,arguments).map(ze);return new x((t,n)=>{e.map(r=>x.resolve(r).then(t,n))})},PSD:{get:()=>A,set:e=>A=e},totalEchoes:{get:()=>ht},newPSD:oe,usePSD:Ce,scheduler:{get:()=>Ie,set:e=>{Ie=e}},rejectionMapper:{get:()=>Mt,set:e=>{Mt=e}},follow:(e,t)=>new x((n,r)=>oe((s,a)=>{var o=A;o.unhandleds=[],o.onunhandled=a,o.finalize=ye(function(){(function(c){function i(){c(),rt.splice(rt.indexOf(i),1)}rt.push(i),++fe,Ie(()=>{--fe==0&&Zt()},[])})(()=>{this.unhandleds.length===0?s():a(this.unhandleds[0])})},o.finalize),e()},t,n,r))}),tt&&(tt.allSettled&&te(x,"allSettled",function(){const e=Z.apply(null,arguments).map(ze);return new x(t=>{e.length===0&&t([]);let n=e.length;const r=new Array(n);e.forEach((s,a)=>x.resolve(s).then(o=>r[a]={status:"fulfilled",value:o},o=>r[a]={status:"rejected",reason:o}).then(()=>--n||t(r)))})}),tt.any&&typeof AggregateError<"u"&&te(x,"any",function(){const e=Z.apply(null,arguments).map(ze);return new x((t,n)=>{e.length===0&&n(new AggregateError([]));let r=e.length;const s=new Array(r);e.forEach((a,o)=>x.resolve(a).then(c=>t(c),c=>{s[o]=c,--r||n(new AggregateError(s))}))})}));const F={awaits:0,echoes:0,id:0};var mr=0,st=[],gt=0,ht=0,gr=0;function oe(e,t,n,r){var s=A,a=Object.create(s);a.parent=s,a.ref=0,a.global=!1,a.id=++gr;var o=Se.env;a.env=Qt?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:an(o.nthen,a),gthen:an(o.gthen,a)}:{},t&&V(a,t),++s.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var c=Ce(a,e,n,r);return a.ref===0&&a.finalize(),c}function Ae(){return F.id||(F.id=++mr),++F.awaits,F.echoes+=100,F.id}function re(){return!!F.awaits&&(--F.awaits==0&&(F.id=0),F.echoes=100*F.awaits,!0)}function ze(e){return F.echoes&&e&&e.constructor===tt?(Ae(),e.then(t=>(re(),t),t=>(re(),B(t)))):e}function br(e){++ht,F.echoes&&--F.echoes!=0||(F.echoes=F.id=0),st.push(A),ie(e,!0)}function vr(){var e=st[st.length-1];st.pop(),ie(e,!1)}function ie(e,t){var n=A;if((t?!F.echoes||gt++&&e===A:!gt||--gt&&e===A)||In(t?br.bind(null,e):vr),e!==A&&(A=e,n===Se&&(Se.env=On()),Qt)){var r=Se.env.Promise,s=e.env;ut.then=s.nthen,r.prototype.then=s.gthen,(n.global||e.global)&&(Object.defineProperty(R,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function On(){var e=R.Promise;return Qt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(R,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ut.then,gthen:e.prototype.then}:{}}function Ce(e,t,n,r,s){var a=A;try{return ie(e,!0),t(n,r,s)}finally{ie(a,!1)}}function In(e){An.call(Pt,e)}function dt(e,t,n,r){return typeof e!="function"?e:function(){var s=A;n&&Ae(),ie(t,!0);try{return e.apply(this,arguments)}finally{ie(s,!1),r&&In(re)}}}function an(e,t){return function(n,r){return e.call(this,dt(n,t),dt(r,t))}}(""+An).indexOf("[native code]")===-1&&(Ae=re=D);function on(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,s={promise:t,reason:e};if(R.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),V(r,s)):R.CustomEvent&&V(r=new CustomEvent("unhandledrejection",{detail:s}),s),r&&R.dispatchEvent&&(dispatchEvent(r),!R.PromiseRejectionEvent&&R.onunhandledrejection))try{R.onunhandledrejection(r)}catch{}z&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var B=x.reject;function It(e,t,n,r){if(e.idbdb&&(e._state.openComplete||A.letThrough||e._vip)){var s=e._createTransaction(t,n,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===zt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>It(e,t,n,r))):B(a)}return s._promise(t,(a,o)=>oe(()=>(A.trans=s,r(a,o,s)))).then(a=>s._completion.then(()=>a))}if(e._state.openComplete)return B(new C.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return B(new C.DatabaseClosed);e.open().catch(D)}return e._state.dbReadyPromise.then(()=>It(e,t,n,r))}const he=String.fromCharCode(65535),Q="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Te=[],yt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),_r=yt,wr=yt,Tn=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function me(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const Nn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xe(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=He(t))[e],t)}class kr{_trans(t,n,r){const s=this._tx||A.trans,a=this.name;function o(i,d,l){if(!l.schema[a])throw new C.NotFound("Table "+a+" not part of transaction");return n(l.idbtrans,l)}const c=We();try{return s&&s.db===this.db?s===A.trans?s._promise(t,o,r):oe(()=>s._promise(t,o,r),{trans:s,transless:A.transless||A}):It(this.db,t,[this.name],o)}finally{c&&$e()}}get(t,n){return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:t}).then(s=>this.hook.reading.fire(s))).then(n)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(L(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const n=N(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(d=>d.compound&&n.every(l=>d.keyPath.indexOf(l)>=0)&&d.keyPath.every(l=>n.indexOf(l)>=0))[0];if(r&&this.db._maxKey!==he)return this.where(r.name).equals(r.keyPath.map(d=>t[d]));!r&&z&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,a=this.db._deps.indexedDB;function o(d,l){try{return a.cmp(d,l)===0}catch{return!1}}const[c,i]=n.reduce(([d,l],h)=>{const u=s[h],p=t[h];return[d||u,d||!u?me(l,u&&u.multi?b=>{const g=ne(b,h);return L(g)&&g.some(v=>o(p,v))}:b=>o(p,ne(b,h))):l]},[null,null]);return c?this.where(c.name).equals(t[c.keyPath]).filter(i):r?this.filter(i):this.where(n).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,L(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const n=r=>{if(!r)return r;const s=Object.create(t.prototype);for(var a in r)if($(r,a))try{s[a]=r[a]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t}defineClass(){return this.mapToClass(function(t){V(this,t)})}add(t,n){const{auto:r,keyPath:s}=this.schema.primKey;let a=t;return s&&r&&(a=Xe(s)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:n!=null?[n]:null,values:[a]})).then(o=>o.numFailures?x.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{Y(t,s,o)}catch{}return o})}update(t,n){if(typeof t!="object"||L(t))return this.where(":id").equals(t).modify(n);{const r=ne(t,this.schema.primKey.keyPath);if(r===void 0)return B(new C.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(s=>{Y(t,s,n[s])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(t,n){const{auto:r,keyPath:s}=this.schema.primKey;let a=t;return s&&r&&(a=Xe(s)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[a],keys:n!=null?[n]:null})).then(o=>o.numFailures?x.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{Y(t,s,o)}catch{}return o})}delete(t){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[t]})).then(n=>n.numFailures?x.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:Nn})).then(t=>t.numFailures?x.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",n=>this.core.getMany({keys:t,trans:n}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,n,r){const s=Array.isArray(n)?n:void 0,a=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:c,keyPath:i}=this.schema.primKey;if(i&&s)throw new C.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new C.InvalidArgument("Arguments objects and keys must have the same length");const d=t.length;let l=i&&c?t.map(Xe(i)):t;return this.core.mutate({trans:o,type:"add",keys:s,values:l,wantResults:a}).then(({numFailures:h,results:u,lastResult:p,failures:b})=>{if(h===0)return a?u:p;throw new Oe(`${this.name}.bulkAdd(): ${h} of ${d} operations failed`,b)})})}bulkPut(t,n,r){const s=Array.isArray(n)?n:void 0,a=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:c,keyPath:i}=this.schema.primKey;if(i&&s)throw new C.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new C.InvalidArgument("Arguments objects and keys must have the same length");const d=t.length;let l=i&&c?t.map(Xe(i)):t;return this.core.mutate({trans:o,type:"put",keys:s,values:l,wantResults:a}).then(({numFailures:h,results:u,lastResult:p,failures:b})=>{if(h===0)return a?u:p;throw new Oe(`${this.name}.bulkPut(): ${h} of ${d} operations failed`,b)})})}bulkDelete(t){const n=t.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:t})).then(({numFailures:r,lastResult:s,failures:a})=>{if(r===0)return s;throw new Oe(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,a)})}}function Ne(e){var t={},n=function(c,i){if(i){for(var d=arguments.length,l=new Array(d-1);--d;)l[d-1]=arguments[d];return t[c].subscribe.apply(null,l),e}if(typeof c=="string")return t[c]};n.addEventType=a;for(var r=1,s=arguments.length;r<s;++r)a(arguments[r]);return n;function a(c,i,d){if(typeof c=="object")return o(c);i||(i=fr),d||(d=D);var l={subscribers:[],fire:d,subscribe:function(h){l.subscribers.indexOf(h)===-1&&(l.subscribers.push(h),l.fire=i(l.fire,h))},unsubscribe:function(h){l.subscribers=l.subscribers.filter(function(u){return u!==h}),l.fire=l.subscribers.reduce(i,d)}};return t[c]=n[c]=l,l}function o(c){N(c).forEach(function(i){var d=c[i];if(L(d))a(i,c[i][0],c[i][1]);else{if(d!=="asap")throw new C.InvalidArgument("Invalid event config");var l=a(i,Fe,function(){for(var h=arguments.length,u=new Array(h);h--;)u[h]=arguments[h];l.subscribers.forEach(function(p){bn(function(){p.apply(null,u)})})})}})}}function De(e,t){return Ee(t).from({prototype:e}),t}function _e(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function bt(e,t){e.filter=me(e.filter,t)}function vt(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>me(r(),t()):t,e.justLimit=n&&!r}function at(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new C.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function cn(e,t,n){const r=at(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Qe(e,t,n,r){const s=e.replayFilter?me(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},o=(c,i,d)=>{if(!s||s(i,d,u=>i.stop(u),u=>i.fail(u))){var l=i.primaryKey,h=""+l;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(l)),$(a,h)||(a[h]=!0,t(c,i,d))}};return Promise.all([e.or._iterate(o,n),un(cn(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return un(cn(e,r,n),me(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function un(e,t,n,r){var s=O(r?(a,o,c)=>n(r(a),o,c):n);return e.then(a=>{if(a)return a.start(()=>{var o=()=>a.continue();t&&!t(a,c=>o=c,c=>{a.stop(c),o=D},c=>{a.fail(c),o=D})||s(a.value,a,c=>o=c),o()})})}function q(e,t){try{const n=ln(e),r=ln(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(s,a){const o=s.length,c=a.length,i=o<c?o:c;for(let d=0;d<i;++d)if(s[d]!==a[d])return s[d]<a[d]?-1:1;return o===c?0:o<c?-1:1}(hn(e),hn(t));case"Array":return function(s,a){const o=s.length,c=a.length,i=o<c?o:c;for(let d=0;d<i;++d){const l=q(s[d],a[d]);if(l!==0)return l}return o===c?0:o<c?-1:1}(e,t)}}catch{}return NaN}function ln(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const n=Et(e);return n==="ArrayBuffer"?"binary":n}function hn(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class Er{_read(t,n){var r=this._ctx;return r.error?r.table._trans(null,B.bind(null,r.error)):r.table._trans("readonly",t).then(n)}_write(t){var n=this._ctx;return n.error?n.table._trans(null,B.bind(null,n.error)):n.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var n=this._ctx;n.algorithm=me(n.algorithm,t)}_iterate(t,n){return Qe(this._ctx,t,n,this._ctx.table.core)}clone(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&V(r,t),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(t){var n=this._ctx;return this._read(r=>Qe(n,t,r,n.table.core))}count(t){return this._read(n=>{const r=this._ctx,s=r.table.core;if(_e(r,!0))return s.count({trans:n,query:{index:at(r,s.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var a=0;return Qe(r,()=>(++a,!1),n,s).then(()=>a)}).then(t)}sortBy(t,n){const r=t.split(".").reverse(),s=r[0],a=r.length-1;function o(d,l){return l?o(d[r[l]],l-1):d[s]}var c=this._ctx.dir==="next"?1:-1;function i(d,l){var h=o(d,a),u=o(l,a);return h<u?-c:h>u?c:0}return this.toArray(function(d){return d.sort(i)}).then(n)}toArray(t){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&_e(r,!0)&&r.limit>0){const{valueMapper:s}=r,a=at(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:a,range:r.range}}).then(({result:o})=>s?o.map(s):o)}{const s=[];return Qe(r,a=>s.push(a),n,r.table.core).then(()=>s)}},t)}offset(t){var n=this._ctx;return t<=0||(n.offset+=t,_e(n)?vt(n,()=>{var r=t;return(s,a)=>r===0||(r===1?(--r,!1):(a(()=>{s.advance(r),r=0}),!1))}):vt(n,()=>{var r=t;return()=>--r<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),vt(this._ctx,()=>{var n=t;return function(r,s,a){return--n<=0&&s(a),n>=0}},!0),this}until(t,n){return bt(this._ctx,function(r,s,a){return!t(r.value)||(s(a),n)}),this}first(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var n,r;return bt(this._ctx,function(s){return t(s.value)}),n=this._ctx,r=t,n.isMatch=me(n.isMatch,r),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){t(s.primaryKey,s)})}keys(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,a){r.push(a.key)}).then(function(){return r}).then(t)}primaryKeys(t){var n=this._ctx;if(n.dir==="next"&&_e(n,!0)&&n.limit>0)return this._read(s=>{var a=at(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(({result:s})=>s).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(n){return n[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return bt(this._ctx,function(s){var a=s.primaryKey.toString(),o=$(r,a);return r[a]=!0,!o}),this}modify(t){var n=this._ctx;return this._write(r=>{var s;if(typeof t=="function")s=t;else{var a=N(t),o=a.length;s=function(g){for(var v=!1,m=0;m<o;++m){var y=a[m],w=t[y];ne(g,y)!==w&&(Y(g,y,w),v=!0)}return v}}const c=n.table.core,{outbound:i,extractKey:d}=c.schema.primaryKey,l=this.db._options.modifyChunkSize||200,h=[];let u=0;const p=[],b=(g,v)=>{const{failures:m,numFailures:y}=v;u+=g-y;for(let w of N(m))h.push(m[w])};return this.clone().primaryKeys().then(g=>{const v=m=>{const y=Math.min(l,g.length-m);return c.getMany({trans:r,keys:g.slice(m,m+y),cache:"immutable"}).then(w=>{const P=[],E=[],_=i?[]:null,k=[];for(let S=0;S<y;++S){const M=w[S],I={value:He(M),primKey:g[m+S]};s.call(I,I.value,I)!==!1&&(I.value==null?k.push(g[m+S]):i||q(d(M),d(I.value))===0?(E.push(I.value),i&&_.push(g[m+S])):(k.push(g[m+S]),P.push(I.value)))}const K=_e(n)&&n.limit===1/0&&(typeof t!="function"||t===_t)&&{index:n.index,range:n.range};return Promise.resolve(P.length>0&&c.mutate({trans:r,type:"add",values:P}).then(S=>{for(let M in S.failures)k.splice(parseInt(M),1);b(P.length,S)})).then(()=>(E.length>0||K&&typeof t=="object")&&c.mutate({trans:r,type:"put",keys:_,values:E,criteria:K,changeSpec:typeof t!="function"&&t}).then(S=>b(E.length,S))).then(()=>(k.length>0||K&&t===_t)&&c.mutate({trans:r,type:"delete",keys:k,criteria:K}).then(S=>b(k.length,S))).then(()=>g.length>m+y&&v(m+l))})};return v(0).then(()=>{if(h.length>0)throw new ct("Error modifying one or more objects",h,u,p);return g.length})})})}delete(){var t=this._ctx,n=t.range;return _e(t)&&(t.isPrimKey&&!wr||n.type===3)?this._write(r=>{const{primaryKey:s}=t.table.core.schema,a=n;return t.table.core.count({trans:r,query:{index:s,range:a}}).then(o=>t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(({failures:c,lastResult:i,results:d,numFailures:l})=>{if(l)throw new ct("Could not delete some values",Object.keys(c).map(h=>c[h]),o-l);return o-l}))}):this.modify(_t)}}const _t=(e,t)=>t.value=null;function xr(e,t){return e<t?-1:e===t?0:1}function Sr(e,t){return e>t?-1:e===t?0:1}function W(e,t,n){var r=e instanceof jn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function we(e){return new e.Collection(e,()=>Bn("")).limit(0)}function Pr(e,t,n,r,s,a){for(var o=Math.min(e.length,r.length),c=-1,i=0;i<o;++i){var d=t[i];if(d!==r[i])return s(e[i],n[i])<0?e.substr(0,i)+n[i]+n.substr(i+1):s(e[i],r[i])<0?e.substr(0,i)+r[i]+n.substr(i+1):c>=0?e.substr(0,c)+t[c]+n.substr(c+1):null;s(e[i],d)<0&&(c=i)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):c<0?null:e.substr(0,c)+r[c]+n.substr(c+1)}function Je(e,t,n,r){var s,a,o,c,i,d,l,h=n.length;if(!n.every(g=>typeof g=="string"))return W(e,"String expected.");function u(g){s=function(m){return m==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(g),a=function(m){return m==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(g),o=g==="next"?xr:Sr;var v=n.map(function(m){return{lower:a(m),upper:s(m)}}).sort(function(m,y){return o(m.lower,y.lower)});c=v.map(function(m){return m.upper}),i=v.map(function(m){return m.lower}),d=g,l=g==="next"?"":r}u("next");var p=new e.Collection(e,()=>se(c[0],i[h-1]+r));p._ondirectionchange=function(g){u(g)};var b=0;return p._addAlgorithm(function(g,v,m){var y=g.key;if(typeof y!="string")return!1;var w=a(y);if(t(w,i,b))return!0;for(var P=null,E=b;E<h;++E){var _=Pr(y,w,c[E],i[E],o,d);_===null&&P===null?b=E+1:(P===null||o(P,_)>0)&&(P=_)}return v(P!==null?function(){g.continue(P+l)}:m),!1}),p}function se(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Bn(e){return{type:1,lower:e,upper:e}}class jn{get Collection(){return this._ctx.table.db.Collection}between(t,n,r,s){r=r!==!1,s=s===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||s)&&(!r||!s)?we(this):new this.Collection(this,()=>se(t,n,!r,!s))}catch{return W(this,Q)}}equals(t){return t==null?W(this,Q):new this.Collection(this,()=>Bn(t))}above(t){return t==null?W(this,Q):new this.Collection(this,()=>se(t,void 0,!0))}aboveOrEqual(t){return t==null?W(this,Q):new this.Collection(this,()=>se(t,void 0,!1))}below(t){return t==null?W(this,Q):new this.Collection(this,()=>se(void 0,t,!1,!0))}belowOrEqual(t){return t==null?W(this,Q):new this.Collection(this,()=>se(void 0,t))}startsWith(t){return typeof t!="string"?W(this,"String expected."):this.between(t,t+he,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Je(this,(n,r)=>n.indexOf(r[0])===0,[t],he)}equalsIgnoreCase(t){return Je(this,(n,r)=>n===r[0],[t],"")}anyOfIgnoreCase(){var t=Z.apply(ke,arguments);return t.length===0?we(this):Je(this,(n,r)=>r.indexOf(n)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Z.apply(ke,arguments);return t.length===0?we(this):Je(this,(n,r)=>r.some(s=>n.indexOf(s)===0),t,he)}anyOf(){const t=Z.apply(ke,arguments);let n=this._cmp;try{t.sort(n)}catch{return W(this,Q)}if(t.length===0)return we(this);const r=new this.Collection(this,()=>se(t[0],t[t.length-1]));r._ondirectionchange=a=>{n=a==="next"?this._ascending:this._descending,t.sort(n)};let s=0;return r._addAlgorithm((a,o,c)=>{const i=a.key;for(;n(i,t[s])>0;)if(++s,s===t.length)return o(c),!1;return n(i,t[s])===0||(o(()=>{a.continue(t[s])}),!1)}),r}notEqual(t){return this.inAnyRange([[-(1/0),t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Z.apply(ke,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return W(this,Q)}const n=t.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[-(1/0),s]],null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,n){const r=this._cmp,s=this._ascending,a=this._descending,o=this._min,c=this._max;if(t.length===0)return we(this);if(!t.every(y=>y[0]!==void 0&&y[1]!==void 0&&s(y[0],y[1])<=0))return W(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",C.InvalidArgument);const i=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;let l,h=s;function u(y,w){return h(y[0],w[0])}try{l=t.reduce(function(y,w){let P=0,E=y.length;for(;P<E;++P){const _=y[P];if(r(w[0],_[1])<0&&r(w[1],_[0])>0){_[0]=o(_[0],w[0]),_[1]=c(_[1],w[1]);break}}return P===E&&y.push(w),y},[]),l.sort(u)}catch{return W(this,Q)}let p=0;const b=d?y=>s(y,l[p][1])>0:y=>s(y,l[p][1])>=0,g=i?y=>a(y,l[p][0])>0:y=>a(y,l[p][0])>=0;let v=b;const m=new this.Collection(this,()=>se(l[0][0],l[l.length-1][1],!i,!d));return m._ondirectionchange=y=>{y==="next"?(v=b,h=s):(v=g,h=a),l.sort(u)},m._addAlgorithm((y,w,P)=>{for(var E=y.key;v(E);)if(++p,p===l.length)return w(P),!1;return!!function(_){return!b(_)&&!g(_)}(E)||(this._cmp(E,l[p][1])===0||this._cmp(E,l[p][0])===0||w(()=>{h===s?y.continue(l[p][0]):y.continue(l[p][1])}),!1)}),m}startsWithAnyOf(){const t=Z.apply(ke,arguments);return t.every(n=>typeof n=="string")?t.length===0?we(this):this.inAnyRange(t.map(n=>[n,n+he])):W(this,"startsWithAnyOf() only works with strings")}}function G(e){return O(function(t){return Ue(t),e(t.target.error),!1})}function Ue(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const ce=Ne(null,"storagemutated");class Ar{_lock(){return Me(!A.global),++this._reculock,this._reculock!==1||A.global||(A.lockOwnerFor=this),this}_unlock(){if(Me(!A.global),--this._reculock==0)for(A.global||(A.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Ce(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&A.lockOwnerFor!==this}create(t){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(Me(!this.idbtrans),!t&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new C.DatabaseClosed(r);case"MissingAPIError":throw new C.MissingAPI(r.message,r);default:throw new C.OpenFailed(r)}if(!this.active)throw new C.TransactionInactive;return Me(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=O(s=>{Ue(s),this._reject(t.error)}),t.onabort=O(s=>{Ue(s),this.active&&this._reject(new C.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=O(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&ce.storagemutated.fire(t.mutatedParts)}),this}_promise(t,n,r){if(t==="readwrite"&&this.mode!=="readwrite")return B(new C.ReadOnly("Transaction is readonly"));if(!this.active)return B(new C.TransactionInactive);if(this._locked())return new x((a,o)=>{this._blockedFuncs.push([()=>{this._promise(t,n,r).then(a,o)},A])});if(r)return oe(()=>{var a=new x((o,c)=>{this._lock();const i=n(o,c,this);i&&i.then&&i.then(o,c)});return a.finally(()=>this._unlock()),a._lib=!0,a});var s=new x((a,o)=>{var c=n(a,o,this);c&&c.then&&c.then(a,o)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var n=this._root();const r=x.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new x((o,c)=>{r.then(i=>n._waitingQueue.push(O(o.bind(null,i))),i=>n._waitingQueue.push(O(c.bind(null,i)))).finally(()=>{n._waitingFor===a&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new C.Abort))}table(t){const n=this._memoizedTables||(this._memoizedTables={});if($(n,t))return n[t];const r=this.schema[t];if(!r)throw new C.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,r,this);return s.core=this.db.core.table(t),n[t]=s,s}}function Tt(e,t,n,r,s,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:s,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(s?"++":"")+Fn(t)}}function Fn(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Ln(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:vn(n,r=>[r.name,r])}}let qe=e=>{try{return e.only([[]]),qe=()=>[[]],[[]]}catch{return qe=()=>he,he}};function Nt(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>ne(n,t)}(e):t=>ne(t,e)}function dn(e){return[].slice.call(e)}let Cr=0;function Be(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function Kr(e,t,n){function r(i){if(i.type===3)return null;if(i.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:d,upper:l,lowerOpen:h,upperOpen:u}=i;return d===void 0?l===void 0?null:t.upperBound(l,!!u):l===void 0?t.lowerBound(d,!!h):t.bound(d,l,!!h,!!u)}const{schema:s,hasGetAll:a}=function(i,d){const l=dn(i.objectStoreNames);return{schema:{name:i.name,tables:l.map(h=>d.objectStore(h)).map(h=>{const{keyPath:u,autoIncrement:p}=h,b=L(u),g=u==null,v={},m={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:b,keyPath:u,autoIncrement:p,unique:!0,extractKey:Nt(u)},indexes:dn(h.indexNames).map(y=>h.index(y)).map(y=>{const{name:w,unique:P,multiEntry:E,keyPath:_}=y,k={name:w,compound:L(_),keyPath:_,unique:P,multiEntry:E,extractKey:Nt(_)};return v[Be(_)]=k,k}),getIndexByKeyPath:y=>v[Be(y)]};return v[":id"]=m.primaryKey,u!=null&&(v[Be(u)]=m.primaryKey),m})},hasGetAll:l.length>0&&"getAll"in d.objectStore(l[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),o=s.tables.map(i=>function(d){const l=d.name;return{name:l,schema:d,mutate:function({trans:h,type:u,keys:p,values:b,range:g}){return new Promise((v,m)=>{v=O(v);const y=h.objectStore(l),w=y.keyPath==null,P=u==="put"||u==="add";if(!P&&u!=="delete"&&u!=="deleteRange")throw new Error("Invalid operation type: "+u);const{length:E}=p||b||{length:1};if(p&&b&&p.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(E===0)return v({numFailures:0,failures:{},results:[],lastResult:void 0});let _;const k=[],K=[];let S=0;const M=U=>{++S,Ue(U)};if(u==="deleteRange"){if(g.type===4)return v({numFailures:S,failures:K,results:[],lastResult:void 0});g.type===3?k.push(_=y.clear()):k.push(_=y.delete(r(g)))}else{const[U,j]=P?w?[b,p]:[b,null]:[p,null];if(P)for(let T=0;T<E;++T)k.push(_=j&&j[T]!==void 0?y[u](U[T],j[T]):y[u](U[T])),_.onerror=M;else for(let T=0;T<E;++T)k.push(_=y[u](U[T])),_.onerror=M}const I=U=>{const j=U.target.result;k.forEach((T,be)=>T.error!=null&&(K[be]=T.error)),v({numFailures:S,failures:K,results:u==="delete"?p:k.map(T=>T.result),lastResult:j})};_.onerror=U=>{M(U),I(U)},_.onsuccess=I})},getMany:({trans:h,keys:u})=>new Promise((p,b)=>{p=O(p);const g=h.objectStore(l),v=u.length,m=new Array(v);let y,w=0,P=0;const E=k=>{const K=k.target;m[K._pos]=K.result,++P===w&&p(m)},_=G(b);for(let k=0;k<v;++k)u[k]!=null&&(y=g.get(u[k]),y._pos=k,y.onsuccess=E,y.onerror=_,++w);w===0&&p(m)}),get:({trans:h,key:u})=>new Promise((p,b)=>{p=O(p);const g=h.objectStore(l).get(u);g.onsuccess=v=>p(v.target.result),g.onerror=G(b)}),query:function(h){return u=>new Promise((p,b)=>{p=O(p);const{trans:g,values:v,limit:m,query:y}=u,w=m===1/0?void 0:m,{index:P,range:E}=y,_=g.objectStore(l),k=P.isPrimaryKey?_:_.index(P.name),K=r(E);if(m===0)return p({result:[]});if(h){const S=v?k.getAll(K,w):k.getAllKeys(K,w);S.onsuccess=M=>p({result:M.target.result}),S.onerror=G(b)}else{let S=0;const M=v||!("openKeyCursor"in k)?k.openCursor(K):k.openKeyCursor(K),I=[];M.onsuccess=U=>{const j=M.result;return j?(I.push(v?j.value:j.primaryKey),++S===m?p({result:I}):void j.continue()):p({result:I})},M.onerror=G(b)}})}(a),openCursor:function({trans:h,values:u,query:p,reverse:b,unique:g}){return new Promise((v,m)=>{v=O(v);const{index:y,range:w}=p,P=h.objectStore(l),E=y.isPrimaryKey?P:P.index(y.name),_=b?g?"prevunique":"prev":g?"nextunique":"next",k=u||!("openKeyCursor"in E)?E.openCursor(r(w),_):E.openKeyCursor(r(w),_);k.onerror=G(m),k.onsuccess=O(K=>{const S=k.result;if(!S)return void v(null);S.___id=++Cr,S.done=!1;const M=S.continue.bind(S);let I=S.continuePrimaryKey;I&&(I=I.bind(S));const U=S.advance.bind(S),j=()=>{throw new Error("Cursor not stopped")};S.trans=h,S.stop=S.continue=S.continuePrimaryKey=S.advance=()=>{throw new Error("Cursor not started")},S.fail=O(m),S.next=function(){let T=1;return this.start(()=>T--?this.continue():this.stop()).then(()=>this)},S.start=T=>{const be=new Promise((H,ue)=>{H=O(H),k.onerror=G(ue),S.fail=ue,S.stop=Ke=>{S.stop=S.continue=S.continuePrimaryKey=S.advance=j,H(Ke)}}),ve=()=>{if(k.result)try{T()}catch(H){S.fail(H)}else S.done=!0,S.start=()=>{throw new Error("Cursor behind last entry")},S.stop()};return k.onsuccess=O(H=>{k.onsuccess=ve,ve()}),S.continue=M,S.continuePrimaryKey=I,S.advance=U,ve(),be},v(S)},m)})},count({query:h,trans:u}){const{index:p,range:b}=h;return new Promise((g,v)=>{const m=u.objectStore(l),y=p.isPrimaryKey?m:m.index(p.name),w=r(b),P=w?y.count(w):y.count();P.onsuccess=O(E=>g(E.target.result)),P.onerror=G(v)})}}}(i)),c={};return o.forEach(i=>c[i.name]=i),{stack:"dbcore",transaction:e.transaction.bind(e),table(i){if(!c[i])throw new Error(`Table '${i}' not found`);return c[i]},MIN_KEY:-1/0,MAX_KEY:qe(t),schema:s}}function Bt({_novip:e},t){const n=t.db,r=function(s,a,{IDBKeyRange:o,indexedDB:c},i){return{dbcore:function(l,h){return h.reduce((u,{create:p})=>({...u,...p(u)}),l)}(Kr(a,o,i),s.dbcore)}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(s=>{const a=s.name;e.core.schema.tables.some(o=>o.name===a)&&(s.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=s.core))})}function ft({_novip:e},t,n,r){n.forEach(s=>{const a=r[s];t.forEach(o=>{const c=$t(o,s);(!c||"value"in c&&c.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?te(o,s,{get(){return this.table(s)},set(i){mn(this,s,{value:i,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new e.Table(s,a))})})}function jt({_novip:e},t){t.forEach(n=>{for(let r in n)n[r]instanceof e.Table&&delete n[r]})}function Dr(e,t){return e._cfg.version-t._cfg.version}function Mr(e,t,n,r){const s=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,s);a.create(n),a._completion.catch(r);const o=a._reject.bind(a),c=A.transless||A;oe(()=>{A.trans=a,A.transless=c,t===0?(N(s).forEach(i=>{wt(n,i,s[i].primKey,s[i].indexes)}),Bt(e,n),x.follow(()=>e.on.populate.fire(a)).catch(o)):function({_novip:i},d,l,h){const u=[],p=i._versions;let b=i._dbSchema=Lt(i,i.idbdb,h),g=!1;function v(){return u.length?x.resolve(u.shift()(l.idbtrans)).then(v):x.resolve()}return p.filter(m=>m._cfg.version>=d).forEach(m=>{u.push(()=>{const y=b,w=m._cfg.dbschema;Ut(i,y,h),Ut(i,w,h),b=i._dbSchema=w;const P=Un(y,w);P.add.forEach(_=>{wt(h,_[0],_[1].primKey,_[1].indexes)}),P.change.forEach(_=>{if(_.recreate)throw new C.Upgrade("Not yet support for changing primary key");{const k=h.objectStore(_.name);_.add.forEach(K=>Ft(k,K)),_.change.forEach(K=>{k.deleteIndex(K.name),Ft(k,K)}),_.del.forEach(K=>k.deleteIndex(K))}});const E=m._cfg.contentUpgrade;if(E&&m._cfg.version>d){Bt(i,h),l._memoizedTables={},g=!0;let _=_n(w);P.del.forEach(M=>{_[M]=y[M]}),jt(i,[i.Transaction.prototype]),ft(i,[i.Transaction.prototype],N(_),_),l.schema=_;const k=Yt(E);let K;k&&Ae();const S=x.follow(()=>{if(K=E(l),K&&k){var M=re.bind(null,null);K.then(M,M)}});return K&&typeof K.then=="function"?x.resolve(K):S.then(()=>K)}}),u.push(y=>{(!g||!_r)&&function(w,P){[].slice.call(P.db.objectStoreNames).forEach(E=>w[E]==null&&P.db.deleteObjectStore(E))}(m._cfg.dbschema,y),jt(i,[i.Transaction.prototype]),ft(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),l.schema=i._dbSchema})}),v().then(()=>{var m,y;y=h,N(m=b).forEach(w=>{y.db.objectStoreNames.contains(w)||wt(y,w,m[w].primKey,m[w].indexes)})})}(e,t,a,n).catch(o)})}function Un(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const s=e[r],a=t[r];if(s){const o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||s.primKey.auto!==a.primKey.auto&&!yt)o.recreate=!0,n.change.push(o);else{const c=s.idxByName,i=a.idxByName;let d;for(d in c)i[d]||o.del.push(d);for(d in i){const l=c[d],h=i[d];l?l.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}else n.add.push([r,a])}return n}function wt(e,t,n,r){const s=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(a=>Ft(s,a)),s}function Ft(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Lt(e,t,n){const r={};return it(t.objectStoreNames,0).forEach(s=>{const a=n.objectStore(s);let o=a.keyPath;const c=Tt(Fn(o),o||"",!1,!1,!!a.autoIncrement,o&&typeof o!="string",!0),i=[];for(let l=0;l<a.indexNames.length;++l){const h=a.index(a.indexNames[l]);o=h.keyPath;var d=Tt(h.name,o,!!h.unique,!!h.multiEntry,!1,o&&typeof o!="string",!1);i.push(d)}r[s]=Ln(s,c,i)}),r}function Ut({_novip:e},t,n){const r=n.db.objectStoreNames;for(let s=0;s<r.length;++s){const a=r[s],o=n.objectStore(a);e._hasGetAll="getAll"in o;for(let c=0;c<o.indexNames.length;++c){const i=o.indexNames[c],d=o.index(i).keyPath,l=typeof d=="string"?d:"["+it(d).join("+")+"]";if(t[a]){const h=t[a].idxByName[l];h&&(h.name=i,delete t[a].idxByName[l],t[a].idxByName[i]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&R.WorkerGlobalScope&&R instanceof R.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class Rr{_parseStoresSpec(t,n){N(t).forEach(r=>{if(t[r]!==null){var s=t[r].split(",").map((o,c)=>{const i=(o=o.trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return Tt(i,d||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),L(d),c===0)}),a=s.shift();if(a.multi)throw new C.Schema("Primary key cannot be multi-valued");s.forEach(o=>{if(o.auto)throw new C.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new C.Schema("Index must have a name and cannot be an empty string")}),n[r]=Ln(r,a,s)}})}stores(t){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?V(this._cfg.storesSource,t):t;const r=n._versions,s={};let a={};return r.forEach(o=>{V(s,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(s,a)}),n._dbSchema=a,jt(n,[n._allTables,n,n.Transaction.prototype]),ft(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(a),a),n._storeNames=N(a),this}upgrade(t){return this._cfg.contentUpgrade=Xt(this._cfg.contentUpgrade||D,t),this}}function en(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new pe("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function tn(e){return e&&typeof e.databases=="function"}function qt(e){return oe(function(){return A.letThrough=!0,e()})}function Or(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function Ir(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?B(t.dbOpenError):e);z&&(t.openCanceller._stackHolder=ge()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function s(){if(t.openCanceller!==r)throw new C.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,o=null,c=!1;return x.race([r,(typeof navigator>"u"?x.resolve():Or()).then(()=>new x((i,d)=>{if(s(),!n)throw new C.MissingAPI;const l=e.name,h=t.autoSchema?n.open(l):n.open(l,Math.round(10*e.verno));if(!h)throw new C.MissingAPI;h.onerror=G(d),h.onblocked=O(e._fireOnBlocked),h.onupgradeneeded=O(u=>{if(o=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=Ue,o.abort(),h.result.close();const b=n.deleteDatabase(l);b.onsuccess=b.onerror=O(()=>{d(new C.NoSuchDatabase(`Database ${l} doesnt exist`))})}else{o.onerror=G(d);var p=u.oldVersion>Math.pow(2,62)?0:u.oldVersion;c=p<1,e._novip.idbdb=h.result,Mr(e,p/10,o,d)}},d),h.onsuccess=O(()=>{o=null;const u=e._novip.idbdb=h.result,p=it(u.objectStoreNames);if(p.length>0)try{const g=u.transaction((b=p).length===1?b[0]:b,"readonly");t.autoSchema?function({_novip:v},m,y){v.verno=m.version/10;const w=v._dbSchema=Lt(0,m,y);v._storeNames=it(m.objectStoreNames,0),ft(v,[v._allTables],N(w),w)}(e,u,g):(Ut(e,e._dbSchema,g),function(v,m){const y=Un(Lt(0,v.idbdb,m),v._dbSchema);return!(y.add.length||y.change.some(w=>w.add.length||w.change.length))}(e,g)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Bt(e,g)}catch{}var b;Te.push(e),u.onversionchange=O(g=>{t.vcFired=!0,e.on("versionchange").fire(g)}),u.onclose=O(g=>{e.on("close").fire(g)}),c&&function({indexedDB:g,IDBKeyRange:v},m){!tn(g)&&m!=="__dbnames"&&en(g,v).put({name:m}).catch(D)}(e._deps,l),i()},d)}))]).then(()=>(s(),t.onReadyBeingFired=[],x.resolve(qt(()=>e.on.ready.fire(e.vip))).then(function i(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(Xt,D);return t.onReadyBeingFired=[],x.resolve(qt(()=>d(e.vip))).then(i)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(i=>{t.dbOpenError=i;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),B(i)}).finally(()=>{t.openComplete=!0,a()})}function Vt(e){var t=a=>e.next(a),n=s(t),r=s(a=>e.throw(a));function s(a){return o=>{var c=a(o),i=c.value;return c.done?i:i&&typeof i.then=="function"?i.then(n,r):L(i)?Promise.all(i).then(n,r):n(i)}}return s(t)()}function Tr(e,t,n){var r=arguments.length;if(r<2)throw new C.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];n=s.pop();var a=wn(s);return[e,a,n]}function qn(e,t,n,r,s){return x.resolve().then(()=>{const a=A.transless||A,o=e._createTransaction(t,n,e._dbSchema,r),c={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===zt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>qn(e,t,n,null,s))):B(h)}const i=Yt(s);let d;i&&Ae();const l=x.follow(()=>{if(d=s.call(o,o),d)if(i){var h=re.bind(null,null);d.then(h,h)}else typeof d.next=="function"&&typeof d.throw=="function"&&(d=Vt(d))},c);return(d&&typeof d.then=="function"?x.resolve(d).then(h=>o.active?h:B(new C.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):l.then(()=>d)).then(h=>(r&&o._resolve(),o._completion.then(()=>h))).catch(h=>(o._reject(h),B(h)))})}function Ze(e,t,n){const r=L(e)?e.slice():[e];for(let s=0;s<n;++s)r.push(t);return r}const Nr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,s={},a=[];function o(l,h,u){const p=Be(l),b=s[p]=s[p]||[],g=l==null?0:typeof l=="string"?1:l.length,v=h>0,m={...u,isVirtual:v,keyTail:h,keyLength:g,extractKey:Nt(l),unique:!v&&u.unique};return b.push(m),m.isPrimaryKey||a.push(m),g>1&&o(g===2?l[0]:l.slice(0,g-1),h+1,u),b.sort((y,w)=>y.keyTail-w.keyTail),m}const c=o(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[c];for(const l of r.indexes)o(l.keyPath,0,l);function i(l){const h=l.query.index;return h.isVirtual?{...l,query:{index:h,range:(u=l.query.range,p=h.keyTail,{type:u.type===1?2:u.type,lower:Ze(u.lower,u.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:Ze(u.upper,u.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0})}}:l;var u,p}return{...n,schema:{...r,primaryKey:c,indexes:a,getIndexByKeyPath:function(l){const h=s[Be(l)];return h&&h[0]}},count:l=>n.count(i(l)),query:l=>n.query(i(l)),openCursor(l){const{keyTail:h,isVirtual:u,keyLength:p}=l.query.index;return u?n.openCursor(i(l)).then(b=>b&&function(g){return Object.create(g,{continue:{value:function(m){m!=null?g.continue(Ze(m,l.reverse?e.MAX_KEY:e.MIN_KEY,h)):l.unique?g.continue(g.key.slice(0,p).concat(l.reverse?e.MIN_KEY:e.MAX_KEY,h)):g.continue()}},continuePrimaryKey:{value(m,y){g.continuePrimaryKey(Ze(m,e.MAX_KEY,h),y)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const m=g.key;return p===1?m[0]:m.slice(0,p)}},value:{get:()=>g.value}})}(b)):n.openCursor(l)}}}}}};function nn(e,t,n,r){return n=n||{},r=r||"",N(e).forEach(s=>{if($(t,s)){var a=e[s],o=t[s];if(typeof a=="object"&&typeof o=="object"&&a&&o){const c=Et(a);c!==Et(o)?n[r+s]=t[s]:c==="Object"?nn(a,o,n,r+s+"."):a!==o&&(n[r+s]=t[s])}else a!==o&&(n[r+s]=t[s])}else n[r+s]=void 0}),N(t).forEach(s=>{$(e,s)||(n[r+s]=t[s])}),n}const Br={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema;return{...n,mutate(a){const o=A.trans,{deleting:c,creating:i,updating:d}=o.table(t).hook;switch(a.type){case"add":if(i.fire===D)break;return o._promise("readwrite",()=>l(a),!0);case"put":if(i.fire===D&&d.fire===D)break;return o._promise("readwrite",()=>l(a),!0);case"delete":if(c.fire===D)break;return o._promise("readwrite",()=>l(a),!0);case"deleteRange":if(c.fire===D)break;return o._promise("readwrite",()=>function(u){return h(u.trans,u.range,1e4)}(a),!0)}return n.mutate(a);function l(u){const p=A.trans,b=u.keys||function(g,v){return v.type==="delete"?v.keys:v.keys||v.values.map(g.extractKey)}(r,u);if(!b)throw new Error("Keys missing");return(u=u.type==="add"||u.type==="put"?{...u,keys:b}:{...u}).type!=="delete"&&(u.values=[...u.values]),u.keys&&(u.keys=[...u.keys]),function(g,v,m){return v.type==="add"?Promise.resolve([]):g.getMany({trans:v.trans,keys:m,cache:"immutable"})}(n,u,b).then(g=>{const v=b.map((m,y)=>{const w=g[y],P={onerror:null,onsuccess:null};if(u.type==="delete")c.fire.call(P,m,w,p);else if(u.type==="add"||w===void 0){const E=i.fire.call(P,m,u.values[y],p);m==null&&E!=null&&(m=E,u.keys[y]=m,r.outbound||Y(u.values[y],r.keyPath,m))}else{const E=nn(w,u.values[y]),_=d.fire.call(P,E,m,w,p);if(_){const k=u.values[y];Object.keys(_).forEach(K=>{$(k,K)?k[K]=_[K]:Y(k,K,_[K])})}}return P});return n.mutate(u).then(({failures:m,results:y,numFailures:w,lastResult:P})=>{for(let E=0;E<b.length;++E){const _=y?y[E]:b[E],k=v[E];_==null?k.onerror&&k.onerror(m[E]):k.onsuccess&&k.onsuccess(u.type==="put"&&g[E]?u.values[E]:_)}return{failures:m,results:y,numFailures:w,lastResult:P}}).catch(m=>(v.forEach(y=>y.onerror&&y.onerror(m)),Promise.reject(m)))})}function h(u,p,b){return n.query({trans:u,values:!1,query:{index:r,range:p},limit:b}).then(({result:g})=>l({type:"delete",keys:g,trans:u}).then(v=>v.numFailures>0?Promise.reject(v.failures[0]):g.length<b?{failures:[],numFailures:0,lastResult:void 0}:h(u,{...p,lower:g[g.length-1],lowerOpen:!0},b)))}}}}})};function Vn(e,t,n){try{if(!t||t.keys.length<e.length)return null;const r=[];for(let s=0,a=0;s<t.keys.length&&a<e.length;++s)q(t.keys[s],e[a])===0&&(r.push(n?He(t.values[s]):t.values[s]),++a);return r.length===e.length?r:null}catch{return null}}const jr={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const s=Vn(r.keys,r.trans._cache,r.cache==="clone");return s?x.resolve(s):n.getMany(r).then(a=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?He(a):a},a))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function rn(e){return!("from"in e)}const J=function(e,t){if(!this){const n=new J;return e&&"d"in e&&V(n,e),n}V(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ve(e,t,n){const r=q(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(rn(e))return V(e,{from:t,to:n,d:1});const s=e.l,a=e.r;if(q(n,e.from)<0)return s?Ve(s,t,n):e.l={from:t,to:n,d:1,l:null,r:null},fn(e);if(q(t,e.to)>0)return a?Ve(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},fn(e);q(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),q(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const o=!e.r;s&&!e.l&&pt(e,s),a&&o&&pt(e,a)}function pt(e,t){rn(t)||function n(r,{from:s,to:a,l:o,r:c}){Ve(r,s,a),o&&n(r,o),c&&n(r,c)}(e,t)}function Fr(e,t){const n=Ht(t);let r=n.next();if(r.done)return!1;let s=r.value;const a=Ht(e);let o=a.next(s.from),c=o.value;for(;!r.done&&!o.done;){if(q(c.from,s.to)<=0&&q(c.to,s.from)>=0)return!0;q(s.from,c.from)<0?s=(r=n.next(c.from)).value:c=(o=a.next(s.from)).value}return!1}function Ht(e){let t=rn(e)?null:{s:0,n:e};return{next(n){const r=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&q(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||q(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function fn(e){var t,n;const r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const a=s==="r"?"l":"r",o={...e},c=e[s];e.from=c.from,e.to=c.to,e[s]=c[s],o[s]=c[a],e[a]=o,o.d=pn(o)}e.d=pn(e)}function pn({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Pe(J.prototype,{add(e){return pt(this,e),this},addKey(e){return Ve(this,e,e),this},addKeys(e){return e.forEach(t=>Ve(this,t,t)),this},[xt](){return Ht(this)}});const Lr={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new J(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const s=e.table(r),{schema:a}=s,{primaryKey:o}=a,{extractKey:c,outbound:i}=o,d={...s,mutate:u=>{const p=u.trans,b=p.mutatedParts||(p.mutatedParts={}),g=_=>{const k=`idb://${t}/${r}/${_}`;return b[k]||(b[k]=new J)},v=g(""),m=g(":dels"),{type:y}=u;let[w,P]=u.type==="deleteRange"?[u.range]:u.type==="delete"?[u.keys]:u.values.length<50?[[],u.values]:[];const E=u.trans._cache;return s.mutate(u).then(_=>{if(L(w)){y!=="delete"&&(w=_.results),v.addKeys(w);const k=Vn(w,E);k||y==="add"||m.addKeys(w),(k||P)&&function(K,S,M,I){function U(j){const T=K(j.name||"");function be(H){return H!=null?j.extractKey(H):null}const ve=H=>j.multiEntry&&L(H)?H.forEach(ue=>T.addKey(ue)):T.addKey(H);(M||I).forEach((H,ue)=>{const Ke=M&&be(M[ue]),mt=I&&be(I[ue]);q(Ke,mt)!==0&&(Ke!=null&&ve(Ke),mt!=null&&ve(mt))})}S.indexes.forEach(U)}(g,a,k,P)}else if(w){const k={from:w.lower,to:w.upper};m.add(k),v.add(k)}else v.add(n),m.add(n),a.indexes.forEach(k=>g(k.name).add(n));return _})}},l=({query:{index:u,range:p}})=>{var b,g;return[u,new J((b=p.lower)!==null&&b!==void 0?b:e.MIN_KEY,(g=p.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},h={get:u=>[o,new J(u.key)],getMany:u=>[o,new J().addKeys(u.keys)],count:l,query:l,openCursor:l};return N(h).forEach(u=>{d[u]=function(p){const{subscr:b}=A;if(b){const g=P=>{const E=`idb://${t}/${r}/${P}`;return b[E]||(b[E]=new J)},v=g(""),m=g(":dels"),[y,w]=h[u](p);if(g(y.name||"").add(w),!y.isPrimaryKey){if(u!=="count"){const P=u==="query"&&i&&p.values&&s.query({...p,values:!1});return s[u].apply(this,arguments).then(E=>{if(u==="query"){if(i&&p.values)return P.then(({result:k})=>(v.addKeys(k),E));const _=p.values?E.result.map(c):E.result;p.values?v.addKeys(_):m.addKeys(_)}else if(u==="openCursor"){const _=E,k=p.values;return _&&Object.create(_,{key:{get:()=>(m.addKey(_.primaryKey),_.key)},primaryKey:{get(){const K=_.primaryKey;return m.addKey(K),K}},value:{get:()=>(k&&v.addKey(_.primaryKey),_.value)}})}return E})}m.add(n)}}return s[u].apply(this,arguments)}}),d}}}};class pe{constructor(t,n){this._middlewares={},this.verno=0;const r=pe.dependencies;this._options=n={addons:pe.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:D,dbReadyPromise:null,cancelOpen:D,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;a.dbReadyPromise=new x(c=>{a.dbReadyResolve=c}),a.openCanceller=new x((c,i)=>{a.cancelOpen=i}),this._state=a,this.name=t,this.on=Ne(this,"populate","blocked","versionchange","close",{ready:[Xt,D]}),this.on.ready.subscribe=gn(this.on.ready.subscribe,c=>(i,d)=>{pe.vip(()=>{const l=this._state;if(l.openComplete)l.dbOpenError||x.resolve().then(i),d&&c(i);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(i),d&&c(i);else{c(i);const h=this;d||c(function u(){h.on.ready.unsubscribe(i),h.on.ready.unsubscribe(u)})}})}),this.Collection=(o=this,De(Er.prototype,function(c,i){this.db=o;let d=Nn,l=null;if(i)try{d=i()}catch(b){l=b}const h=c._ctx,u=h.table,p=u.hook.reading.fire;this._ctx={table:u,index:h.index,isPrimKey:!h.index||u.schema.primKey.keyPath&&h.index===u.schema.primKey.name,range:d,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:l,or:h.or,valueMapper:p!==Fe?p:null}})),this.Table=function(c){return De(kr.prototype,function(i,d,l){this.db=c,this._tx=l,this.name=i,this.schema=d,this.hook=c._allTables[i]?c._allTables[i].hook:Ne(null,{creating:[lr,D],reading:[ur,Fe],updating:[dr,D],deleting:[hr,D]})})}(this),this.Transaction=function(c){return De(Ar.prototype,function(i,d,l,h,u){this.db=c,this.mode=i,this.storeNames=d,this.schema=l,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=Ne(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x((p,b)=>{this._resolve=p,this._reject=b}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},p=>{var b=this.active;return this.active=!1,this.on.error.fire(p),this.parent?this.parent._reject(p):b&&this.idbtrans&&this.idbtrans.abort(),B(p)})})}(this),this.Version=function(c){return De(Rr.prototype,function(i){this.db=c,this._cfg={version:i,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(c){return De(jn.prototype,function(i,d,l){this.db=c,this._ctx={table:i,index:d===":id"?null:d,or:l};const h=c._deps.indexedDB;if(!h)throw new C.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(u,p)=>h.cmp(p,u),this._max=(u,p)=>h.cmp(u,p)>0?u:p,this._min=(u,p)=>h.cmp(u,p)<0?u:p,this._IDBKeyRange=c._deps.IDBKeyRange})}(this),this.on("versionchange",c=>{c.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",c=>{!c.newVersion||c.newVersion<c.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${c.oldVersion/10}`)}),this._maxKey=qe(n.IDBKeyRange),this._createTransaction=(c,i,d,l)=>new this.Transaction(c,i,d,this._options.chromeTransactionDurability,l),this._fireOnBlocked=c=>{this.on("blocked").fire(c),Te.filter(i=>i.name===this.name&&i!==this&&!i._state.vcFired).map(i=>i.on("versionchange").fire(c))},this.use(Nr),this.use(Br),this.use(Lr),this.use(jr),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(c=>c(this))}version(t){if(isNaN(t)||t<.1)throw new C.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new C.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const n=this._versions;var r=n.filter(s=>s._cfg.version===t)[0];return r||(r=new this.Version(t),n.push(r),n.sort(Dr),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(t){return this.idbdb&&(this._state.openComplete||A.letThrough||this._vip)?t():new x((n,r)=>{if(this._state.openComplete)return r(new C.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new C.DatabaseClosed);this.open().catch(D)}this._state.dbReadyPromise.then(n,r)}).then(t)}use({stack:t,create:n,level:r,name:s}){s&&this.unuse({stack:t,name:s});const a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:n,level:r??10,name:s}),a.sort((o,c)=>o.level-c.level),this}unuse({stack:t,name:n,create:r}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>r?s.create!==r:!!n&&s.name!==n)),this}open(){return Ir(this)}_close(){const t=this._state,n=Te.indexOf(this);if(n>=0&&Te.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new x(r=>{t.dbReadyResolve=r}),t.openCanceller=new x((r,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new C.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,n=this._state;return new x((r,s)=>{const a=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=O(()=>{(function({indexedDB:c,IDBKeyRange:i},d){!tn(c)&&d!=="__dbnames"&&en(c,i).delete(d).catch(D)})(this._deps,this.name),r()}),o.onerror=G(s),o.onblocked=this._fireOnBlocked};if(t)throw new C.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return N(this._allTables).map(t=>this._allTables[t])}transaction(){const t=Tr.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,n,r){let s=A.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const a=t.indexOf("?")!==-1;let o,c;t=t.replace("!","").replace("?","");try{if(c=n.map(d=>{var l=d instanceof this.Table?d.name:d;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t==="readonly")o="readonly";else{if(t!="rw"&&t!="readwrite")throw new C.InvalidArgument("Invalid transaction mode: "+t);o="readwrite"}if(s){if(s.mode==="readonly"&&o==="readwrite"){if(!a)throw new C.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&c.forEach(d=>{if(s&&s.storeNames.indexOf(d)===-1){if(!a)throw new C.SubTransaction("Table "+d+" not included in parent transaction.");s=null}}),a&&s&&!s.active&&(s=null)}}catch(d){return s?s._promise(null,(l,h)=>{h(d)}):B(d)}const i=qn.bind(null,this,o,c,s,r);return s?s._promise(o,i,"lock"):A.trans?Ce(A.transless,()=>this._whenReady(i)):this._whenReady(i)}table(t){if(!$(this._allTables,t))throw new C.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const Ur=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class qr{constructor(t){this._subscribe=t}subscribe(t,n,r){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:n,complete:r})}[Ur](){return this}}function Hn(e,t){return N(t).forEach(n=>{pt(e[n]||(e[n]=new J),t[n])}),e}function Vr(e){return new qr(t=>{const n=Yt(e);let r=!1,s={},a={};const o={get closed(){return r},unsubscribe:()=>{r=!0,ce.storagemutated.unsubscribe(l)}};t.start&&t.start(o);let c=!1,i=!1;function d(){return N(a).some(u=>s[u]&&Fr(s[u],a[u]))}const l=u=>{Hn(s,u),d()&&h()},h=()=>{if(c||r)return;s={};const u={},p=function(b){n&&Ae();const g=()=>oe(e,{subscr:b,trans:null}),v=A.trans?Ce(A.transless,g):g();return n&&v.then(re,re),v}(u);i||(ce("storagemutated",l),i=!0),c=!0,Promise.resolve(p).then(b=>{c=!1,r||(d()?h():(s={},a=u,t.next&&t.next(b)))},b=>{c=!1,t.error&&t.error(b),o.unsubscribe()})};return h(),o})}let Wt;try{Wt={indexedDB:R.indexedDB||R.mozIndexedDB||R.webkitIndexedDB||R.msIndexedDB,IDBKeyRange:R.IDBKeyRange||R.webkitIDBKeyRange}}catch{Wt={indexedDB:null,IDBKeyRange:null}}const le=pe;function ot(e){let t=ee;try{ee=!0,ce.storagemutated.fire(e)}finally{ee=t}}Pe(le,{...et,delete:e=>new le(e,{addons:[]}).delete(),exists:e=>new le(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:n}){return tn(t)?Promise.resolve(t.databases()).then(r=>r.map(s=>s.name).filter(s=>s!=="__dbnames")):en(t,n).toCollection().primaryKeys()}(le.dependencies).then(e)}catch{return B(new C.MissingAPI)}},defineClass:()=>function(e){V(this,e)},ignoreTransaction:e=>A.trans?Ce(A.transless,e):e(),vip:qt,async:function(e){return function(){try{var t=Vt(e.apply(this,arguments));return t&&typeof t.then=="function"?t:x.resolve(t)}catch(n){return B(n)}}},spawn:function(e,t,n){try{var r=Vt(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:x.resolve(r)}catch(s){return B(s)}},currentTransaction:{get:()=>A.trans||null},waitFor:function(e,t){const n=x.resolve(typeof e=="function"?le.ignoreTransaction(e):e).timeout(t||6e4);return A.trans?A.trans.waitFor(n):n},Promise:x,debug:{get:()=>z,set:e=>{En(e,e==="dexie"?()=>!0:Tn)}},derive:Ee,extend:V,props:Pe,override:gn,Events:Ne,on:ce,liveQuery:Vr,extendObservabilitySet:Hn,getByKeyPath:ne,setByKeyPath:Y,delByKeyPath:function(e,t){typeof t=="string"?Y(e,t,void 0):"length"in t&&[].map.call(t,function(n){Y(e,n,void 0)})},shallowClone:_n,deepClone:He,getObjectDiff:nn,cmp:q,asap:bn,minKey:-(1/0),addons:[],connections:Te,errnames:zt,dependencies:Wt,semVer:"3.2.3",version:"3.2.3".split(".").map(e=>parseInt(e)).reduce((e,t,n)=>e+t/Math.pow(10,2*n))}),le.maxKey=qe(le.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ce("storagemutated",e=>{if(!ee){let t;yt?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),ee=!0,dispatchEvent(t),ee=!1}}),addEventListener("x-storagemutated-1",({detail:e})=>{ee||ot(e)}));let ee=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel("x-storagemutated-1");typeof e.unref=="function"&&e.unref(),ce("storagemutated",t=>{ee||e.postMessage(t)}),e.onmessage=t=>{t.data&&ot(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ce("storagemutated",t=>{try{ee||(typeof localStorage<"u"&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:"x-storagemutated-1",changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key==="x-storagemutated-1"){const n=JSON.parse(t.newValue);n&&ot(n.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type==="x-storagemutated-1"&&ot(t.changedParts)})}x.rejectionMapper=function(e,t){if(!e||e instanceof xe||e instanceof TypeError||e instanceof SyntaxError||!e.name||!sn[e.name])return e;var n=new sn[e.name](t||e.message,e);return"stack"in e&&te(n,"stack",{get:function(){return this.inner.stack}}),n},En(z,Tn);class Hr extends pe{constructor(){super("myDatabase");X(this,"roms");X(this,"opts");this.version(3).stores({roms:"crc32, title",opts:"key"})}}const xo=new Hr,So=1,Wr=313,Po=Wr,Ao=227,Co=313,Ko=912,Do=18,Mo=26,Ro={Escape:69,F1:80,F2:81,F3:82,F4:83,F5:84,F6:85,F7:86,F8:87,F9:88,F10:89,F11:102,F12:103,Backquote:0,Digit1:1,Digit2:2,Digit3:3,Digit4:4,Digit5:5,Digit6:6,Digit7:7,Digit8:8,Digit9:9,Digit0:10,Minus:11,Equal:12,Backspace:65,Tab:66,KeyQ:16,KeyW:17,KeyE:18,KeyR:19,KeyT:20,KeyY:21,KeyU:22,KeyI:23,KeyO:24,KeyP:25,BracketLeft:26,BracketRight:27,Backslash:13,CapsLock:98,KeyA:32,KeyS:33,KeyD:34,KeyF:35,KeyG:36,KeyH:37,KeyJ:38,KeyK:39,KeyL:40,Semicolon:41,Quote:42,Enter:68,ShiftLeft:96,KeyZ:49,KeyX:50,KeyC:51,KeyV:52,KeyB:53,KeyN:54,KeyM:55,Comma:56,Period:57,Slash:58,ShiftRight:97,ControlLeft:99,AltLeft:100,MetaLeft:102,Space:64,AltRight:101,MetaRight:103,ControlRight:99,Delete:70,End:95,PageDown:69,ArrowUp:76,ArrowDown:77,ArrowRight:78,ArrowLeft:79,NumpadDivide:92,NumpadMultiply:93,NumpadSubtract:74,Numpad7:61,Numpad8:62,Numpad9:63,NumpadAdd:94,Numpad4:45,Numpad5:46,Numpad6:47,Numpad1:29,Numpad2:30,Numpad3:31,NumpadEnter:67,Numpad0:15,NumpadDecimal:60},Oo={Aros:1062194186,Kick12:2798523958,Kick13:3304125791,DiagROM:2231503309};export{Wa as $,ho as A,lo as B,uo as C,co as D,io as E,oo as F,ao as G,vs as H,Gn as I,so as J,ro as K,no as L,Eo as M,to as N,Yn as O,eo as P,Za as Q,zn as R,Ja as S,Xn as T,Qa as U,Xa as V,Qn as W,za as X,Ga as Y,Ya as Z,$a as _,Jr as a,js as a$,Ha as a0,Va as a1,qa as a2,Ua as a3,La as a4,Fa as a5,ja as a6,Ba as a7,Na as a8,Ta as a9,ca as aA,ia as aB,ls as aC,us as aD,cs as aE,is as aF,ea as aG,Zs as aH,na as aI,Js as aJ,Ws as aK,ss as aL,rs as aM,ns as aN,ts as aO,Qs as aP,Xs as aQ,zs as aR,Gs as aS,Ys as aT,$s as aU,Vs as aV,Fs as aW,gs as aX,qs as aY,Us as aZ,Ls as a_,Ia as aa,Oa as ab,Ra as ac,Ma as ad,Da as ae,Ka as af,Ca as ag,Aa as ah,Pa as ai,Sa as aj,xa as ak,Ea as al,ka as am,wa as an,_a as ao,va as ap,ba as aq,ga as ar,ma as as,ya as at,pa as au,fa as av,da as aw,ha as ax,la as ay,ua as az,Xr as b,Bs as b0,as as b1,As as b2,Ps as b3,bs as b4,ms as b5,ys as b6,ps as b7,fs as b8,es as b9,Ts as bA,Zr as ba,Qr as bb,Is as bc,sa as bd,yn as be,Oo as bf,ws as bg,Rs as bh,Os as bi,ra as bj,Ko as bk,Co as bl,Ro as bm,So as bn,Do as bo,Ao as bp,Mo as bq,Po as br,Ms as bs,Ds as bt,Ks as bu,Cs as bv,Gr as bw,Jn as bx,ta as by,Ns as bz,_s as c,ks as d,Vr as e,xo as f,Ss as g,hs as h,Es as i,ds as j,xs as k,aa as l,os as m,ko as n,wo as o,zr as p,_o as q,Hs as r,vo as s,bo as t,go as u,mo as v,oa as w,yo as x,po as y,fo as z};
